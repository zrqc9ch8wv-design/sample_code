<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼ç”Ÿæˆãƒ„ãƒ¼ãƒ«ï¼ˆã‚³ãƒ¼ãƒ‰è¡¨ç¤ºç‰ˆï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 16px;
        }

        .info-box {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #4a9fd8;
        }

        .info-box h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
            color: #34495e;
        }

        .info-box li {
            margin-bottom: 5px;
        }

        .add-file-btn {
            background: #4a9fd8;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .add-file-btn:hover {
            background: #3d8ac4;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 159, 216, 0.3);
        }

        .file-list {
            margin-bottom: 30px;
        }

        .file-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            cursor: move;
            transition: all 0.3s ease;
        }

        .file-item:hover {
            border-color: #4a9fd8;
            background: #e3f2fd;
        }

        .file-item.dragging {
            opacity: 0.5;
            border-color: #4a9fd8;
        }

        .file-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-name {
            font-weight: 600;
            color: #2c3e50;
            flex: 1;
        }

        .drag-handle {
            color: #999;
            font-size: 20px;
            margin-right: 10px;
            cursor: move;
        }

        .file-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .duration-input {
            width: 80px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 14px;
        }

        .delete-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .delete-btn:hover {
            background: #c0392b;
        }

        .animation-section {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #ffc107;
        }

        .animation-section h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .animation-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .animation-option {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 15px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
        }

        .animation-option:hover {
            border-color: #ffc107;
            background: #fffbeb;
        }

        .animation-option input {
            cursor: pointer;
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #28a745;
            display: none;
        }

        .file-count {
            background: #d4edda;
            color: #155724;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: 600;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼ç”Ÿæˆãƒ„ãƒ¼ãƒ«</h1>
        <p class="subtitle">ç”»åƒã¨PDFã‚’é¸æŠã—ã¦ã€è‡ªå‹•å†ç”Ÿã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼HTMLã‚’ç”Ÿæˆã—ã¾ã™</p>

        <div class="info-box">
            <h3>ğŸ’¡ ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¤ã„ã¦</h3>
            <p>
                ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒå‘ã‘ã§ã™ã€‚<br>
                ç”Ÿæˆã•ã‚ŒãŸHTMLã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ãƒ¡ãƒ¢å¸³ã«è²¼ã‚Šä»˜ã‘ã¦HTMLå½¢å¼ã§ä¿å­˜ã—ã¦ãã ã•ã„ã€‚
            </p>
        </div>

        <div class="file-count" id="fileCount"></div>

        <button class="add-file-btn" onclick="document.getElementById('fileInput').click()">
            ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ï¼ˆç”»åƒãƒ»PDFï¼‰
        </button>
        <input type="file" id="fileInput" multiple accept="image/*,.pdf" style="display: none;">

        <div class="file-list" id="fileList"></div>

        <div class="animation-section">
            <h3>ğŸ¨ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</h3>
            <div class="animation-options">
                <label class="animation-option">
                    <input type="checkbox" value="fade" checked> ãƒ•ã‚§ãƒ¼ãƒ‰
                </label>
                <label class="animation-option">
                    <input type="checkbox" value="slide-right" checked> ã‚¹ãƒ©ã‚¤ãƒ‰ï¼ˆå³â†’ï¼‰
                </label>
                <label class="animation-option">
                    <input type="checkbox" value="slide-left" checked> ã‚¹ãƒ©ã‚¤ãƒ‰ï¼ˆâ†å·¦ï¼‰
                </label>
                <label class="animation-option">
                    <input type="checkbox" value="zoom-in" checked> ã‚ºãƒ¼ãƒ ã‚¤ãƒ³
                </label>
                <label class="animation-option">
                    <input type="checkbox" value="zoom-out" checked> ã‚ºãƒ¼ãƒ ã‚¢ã‚¦ãƒˆ
                </label>
            </div>
        </div>

        <button class="generate-btn" id="generateBtn" onclick="generateHTML()" disabled>
            ğŸ”¨ HTMLã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
        </button>

        <div class="success-message" id="successMessage" style="display: none;">
            âœ… HTMLã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚
        </div>
        
        <div id="codeSection" style="display: none; margin-top: 30px;">
            <div style="background: #2c3e50; color: white; padding: 15px 20px; border-radius: 10px 10px 0 0; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0;">ğŸ“„ ç”Ÿæˆã•ã‚ŒãŸHTMLã‚³ãƒ¼ãƒ‰</h3>
                <button id="copyBtn" onclick="copyCode()" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: 600;">ğŸ“‹ å…¨é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼</button>
            </div>
            <textarea id="codeArea" readonly style="width: 100%; height: 400px; padding: 20px; border: 2px solid #2c3e50; border-top: none; border-radius: 0 0 10px 10px; font-family: 'Courier New', monospace; font-size: 12px; resize: vertical; background: #f8f9fa;"></textarea>
            
            <div style="background: #d4edda; padding: 20px; border-radius: 10px; margin-top: 20px; border-left: 4px solid #28a745;">
                <h3 style="color: #155724; margin-bottom: 10px;">ğŸ“ æ¬¡ã®æ‰‹é †</h3>
                <ol style="margin-left: 20px; color: #155724;">
                    <li style="margin-bottom: 8px;">ã€ŒğŸ“‹ å…¨é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    <li style="margin-bottom: 8px;">ãƒ¡ãƒ¢å¸³ï¼ˆNotepadï¼‰ã‚’é–‹ã</li>
                    <li style="margin-bottom: 8px;">Ctrl+V ã§ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘</li>
                    <li style="margin-bottom: 8px;">ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã€â†’ã€Œåå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€</li>
                    <li style="margin-bottom: 8px;">ãƒ•ã‚¡ã‚¤ãƒ«å: <code>slideshow_final.html</code></li>
                    <li style="margin-bottom: 8px;">ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡: <code>ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«</code></li>
                    <li style="margin-bottom: 8px;">ä¿å­˜ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    <li style="margin-bottom: 8px;">å®Œæˆï¼ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§èµ·å‹•ã—ã¾ã™</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        let slides = [];
        let draggedIndex = null;

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            if (files.length === 0) return;
            
            files.forEach(file => {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    slides.push({
                        data: event.target.result,
                        name: file.name,
                        type: file.type.startsWith('image/') ? 'image' : 'pdf',
                        duration: 5
                    });
                    
                    updateFileList();
                    updateFileCount();
                };
                
                reader.readAsDataURL(file);
            });
            
            e.target.value = '';
        });

        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';

            slides.forEach((slide, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.draggable = true;
                fileItem.dataset.index = index;

                fileItem.innerHTML = '<div class="file-item-header">' +
                    '<span class="drag-handle">â˜°</span>' +
                    '<span class="file-name">' + (slide.type === 'image' ? 'ğŸ–¼ï¸' : 'ğŸ“„') + ' ' + slide.name + '</span>' +
                    '<div class="file-controls">' +
                    '<input type="number" class="duration-input" value="' + slide.duration + '" min="1" max="300" onchange="updateDuration(' + index + ', this.value)">' +
                    '<span style="color: #666;">ç§’</span>' +
                    '<button class="delete-btn" onclick="removeFile(' + index + ')">å‰Šé™¤</button>' +
                    '</div>' +
                    '</div>';

                fileItem.addEventListener('dragstart', function() {
                    draggedIndex = index;
                    this.classList.add('dragging');
                });

                fileItem.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });

                fileItem.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });

                fileItem.addEventListener('drop', function(e) {
                    e.preventDefault();
                    const dropIndex = parseInt(this.dataset.index);
                    
                    if (draggedIndex !== dropIndex) {
                        const removed = slides.splice(draggedIndex, 1)[0];
                        slides.splice(dropIndex, 0, removed);
                        updateFileList();
                    }
                });

                fileList.appendChild(fileItem);
            });
        }

        function updateDuration(index, value) {
            slides[index].duration = parseInt(value);
        }

        function removeFile(index) {
            slides.splice(index, 1);
            updateFileList();
            updateFileCount();
        }

        function updateFileCount() {
            const count = slides.length;
            const fileCount = document.getElementById('fileCount');
            const generateBtn = document.getElementById('generateBtn');
            
            if (count > 0) {
                fileCount.style.display = 'block';
                fileCount.textContent = 'âœ… ' + count + 'å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™';
                generateBtn.disabled = false;
            } else {
                fileCount.style.display = 'none';
                generateBtn.disabled = true;
            }
        }

        function generateHTML() {
            if (slides.length === 0) {
                alert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¦ãã ã•ã„');
                return;
            }

            const selectedAnimations = Array.from(document.querySelectorAll('.animation-option input:checked'))
                .map(function(input) { return input.value; });

            if (selectedAnimations.length === 0) {
                alert('å°‘ãªãã¨ã‚‚1ã¤ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            const htmlContent = generateHTMLContent(slides, selectedAnimations);
            
            // ã‚³ãƒ¼ãƒ‰ã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è¡¨ç¤º
            document.getElementById('codeArea').value = htmlContent;
            document.getElementById('codeSection').style.display = 'block';
            document.getElementById('successMessage').style.display = 'block';
            
            // ã‚³ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            setTimeout(function() {
                document.getElementById('codeSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }
        
        function copyCode() {
            const codeArea = document.getElementById('codeArea');
            
            // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å½“ã¦ã‚‹
            codeArea.focus();
            
            // å…¨ç¯„å›²ã‚’é¸æŠï¼ˆã‚ˆã‚Šç¢ºå®Ÿãªæ–¹æ³•ï¼‰
            codeArea.select();
            codeArea.setSelectionRange(0, codeArea.value.length);
            
            try {
                // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰APIã‚’å„ªå…ˆçš„ã«ä½¿ç”¨
                if (navigator.clipboard && window.isSecureContext) {
                    navigator.clipboard.writeText(codeArea.value).then(function() {
                        const copyBtn = document.getElementById('copyBtn');
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                        copyBtn.style.background = '#3498db';
                        
                        setTimeout(function() {
                            copyBtn.textContent = originalText;
                            copyBtn.style.background = '#27ae60';
                        }, 3000);
                    }).catch(function(err) {
                        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: execCommand
                        fallbackCopy();
                    });
                } else {
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: execCommand
                    fallbackCopy();
                }
            } catch (err) {
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦Ctrl+Cã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
            }
            
            function fallbackCopy() {
                const success = document.execCommand('copy');
                if (success) {
                    const copyBtn = document.getElementById('copyBtn');
                    const originalText = copyBtn.textContent;
                    copyBtn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
                    copyBtn.style.background = '#3498db';
                    
                    setTimeout(function() {
                        copyBtn.textContent = originalText;
                        copyBtn.style.background = '#27ae60';
                    }, 3000);
                } else {
                    alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦Ctrl+Cã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
                }
            }
        }

        function generateHTMLContent(slides, animations) {
            const slidesJSON = JSON.stringify(slides);
            const animationsJSON = JSON.stringify(animations);
            
            // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«ã‚’ä½¿ã£ã¦å®Ÿéš›ã®æ”¹è¡Œã‚’å«ã‚€HTMLã‚’ç”Ÿæˆ
            const html = `<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå‹•ã‚¹ãƒ©ã‚¤ãƒ‰ã‚·ãƒ§ãƒ¼</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #000; overflow: hidden; width: 100vw; height: 100vh; }
        .slideshow-container { position: relative; width: 100%; height: 100%; background: #000; }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; display: flex; justify-content: center; align-items: center; background: #000; }
        .slide.active { opacity: 1; z-index: 2; }
        .slide img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .slide iframe { width: 100%; height: 100%; border: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideRight { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideLeft { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes zoomOut { from { transform: scale(1.2); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .slide.fade { animation: fadeIn 1s ease-in-out; }
        .slide.slide-right { animation: slideRight 1s ease-in-out; }
        .slide.slide-left { animation: slideLeft 1s ease-in-out; }
        .slide.zoom-in { animation: zoomIn 1s ease-in-out; }
        .slide.zoom-out { animation: zoomOut 1s ease-in-out; }
        .controls { position: fixed; bottom: 20px; right: 20px; background: rgba(0, 0, 0, 0.8); padding: 15px 20px; border-radius: 10px; display: flex; gap: 10px; align-items: center; opacity: 0; transition: opacity 0.3s ease; z-index: 1000; }
        body:hover .controls { opacity: 1; }
        .controls button { background: #4a9fd8; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; }
        .controls button:hover { background: #3d8ac4; transform: scale(1.05); }
        .controls .info { color: white; font-size: 14px; margin-right: 10px; }
        .fullscreen-btn { position: fixed; top: 20px; right: 20px; background: rgba(74, 159, 216, 0.8); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; transition: all 0.3s ease; z-index: 1000; opacity: 0; }
        body:hover .fullscreen-btn { opacity: 1; }
        .fullscreen-btn:hover { background: rgba(61, 138, 196, 0.9); transform: scale(1.05); }
    </style>
</head>
<body>
    <button class="fullscreen-btn" id="fullscreenBtn" onclick="toggleFullscreen()">ğŸ–¥ï¸ ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³</button>
    <div class="slideshow-container" id="slideshowContainer"></div>
    <div class="controls">
        <span class="info" id="slideInfo">-</span>
        <button onclick="previousSlide()">â®ï¸ å‰ã¸</button>
        <button onclick="togglePause()" id="pauseBtn">â¸ï¸ ä¸€æ™‚åœæ­¢</button>
        <button onclick="nextSlide()">æ¬¡ã¸ â­ï¸</button>
    </div>
    <script>
        const slides = ${slidesJSON};
        const animations = ${animationsJSON};
        let currentSlideIndex = 0;
        let isPaused = false;
        let currentSlideTimer = null;
        let imagesLoaded = 0;
        setInterval(function() { location.reload(); }, 6 * 60 * 60 * 1000);
        function renderSlides() {
            const container = document.getElementById("slideshowContainer");
            container.innerHTML = "";
            slides.forEach(function(slide, index) {
                const slideDiv = document.createElement("div");
                slideDiv.className = "slide";
                slideDiv.dataset.index = index;
                if (slide.type === "image") {
                    const img = document.createElement("img");
                    img.src = slide.data;
                    img.onload = function() {
                        imagesLoaded++;
                        if (imagesLoaded === slides.filter(function(s) { return s.type === "image"; }).length) {
                            setTimeout(function() { showSlide(0); }, 100);
                        }
                    };
                    slideDiv.appendChild(img);
                } else {
                    const iframe = document.createElement("iframe");
                    iframe.src = slide.data + "#view=Fit&toolbar=0&navpanes=0&scrollbar=0";
                    slideDiv.appendChild(iframe);
                }
                container.appendChild(slideDiv);
            });
            if (slides.filter(function(s) { return s.type === "image"; }).length === 0) {
                setTimeout(function() { showSlide(0); }, 100);
            }
        }
        function showSlide(index) {
            const allSlides = document.querySelectorAll(".slide");
            const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
            allSlides.forEach(function(slide) {
                slide.classList.remove("active", "fade", "slide-right", "slide-left", "zoom-in", "zoom-out");
            });
            if (allSlides[index]) {
                allSlides[index].classList.add("active", randomAnimation);
            }
            currentSlideIndex = index;
            document.getElementById("slideInfo").textContent = (currentSlideIndex + 1) + " / " + slides.length + " (" + slides[currentSlideIndex].duration + "ç§’)";
            if (currentSlideTimer) clearTimeout(currentSlideTimer);
            currentSlideTimer = setTimeout(function() {
                if (!isPaused) nextSlide();
            }, slides[index].duration * 1000);
        }
        function nextSlide() {
            currentSlideIndex = (currentSlideIndex + 1) % slides.length;
            showSlide(currentSlideIndex);
        }
        function previousSlide() {
            currentSlideIndex = (currentSlideIndex - 1 + slides.length) % slides.length;
            showSlide(currentSlideIndex);
        }
        function togglePause() {
            isPaused = !isPaused;
            const btn = document.getElementById("pauseBtn");
            if (isPaused) {
                btn.textContent = "â–¶ï¸ å†é–‹";
                if (currentSlideTimer) clearTimeout(currentSlideTimer);
            } else {
                btn.textContent = "â¸ï¸ ä¸€æ™‚åœæ­¢";
                showSlide(currentSlideIndex);
            }
        }
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                document.getElementById("fullscreenBtn").textContent = "ğŸ–¥ï¸ çµ‚äº†";
            } else {
                document.exitFullscreen();
                document.getElementById("fullscreenBtn").textContent = "ğŸ–¥ï¸ ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³";
            }
        }
        document.addEventListener("keydown", function(e) {
            switch(e.key) {
                case "ArrowRight": nextSlide(); break;
                case "ArrowLeft": previousSlide(); break;
                case " ": togglePause(); e.preventDefault(); break;
                case "f":
                case "F": toggleFullscreen(); break;
            }
        });
        renderSlides();
    <\/script>
</body>
</html>`;

            return html;
        }

    </script>
</body>
</html>
